---
layout: post
title:  "Java核心类库第六天"
date:   2019-10-30
categories: Java
tags: Java note
---

* content
{:toc}

1. 核心类库第8天：线程的同步机制、网络编程常识、基于tcp协议的编程模型









# Java核心类库第六天
## Java深入篇--核心类库--第8天
### 线程的同步机制
1. 基本概念：
    1. 当多个线程同时访问同一种共享资源时，可能会造成数据的覆盖等不一致性问题，此时就需要进行线程之间的通信和协调，该机制就叫线程的同步机制。
    2. 例如：2003年   存折 和 银行卡    对应同一个账户
2. 解决方案
    1. 由程序结果可知：当两个线程同时进行取款时，导致最终的账户余额不合理
    2. 引发原因：线程一还没有执行完毕取款操作，此时线程二已经开始取款操作
    3. 解决方案：让两个线程的并发操作改为串行操作即可，也就是依次执行取款操作
    4. 方案的缺点：若依次启动多个线程则导致多线程的意义不复存在。
3. 实现方式
    1. 在Java语言中使用synchronized关键字来实现同步/对象锁机制，来保证线程执行该段代码时的原子性(要么不执行，要么就执行完整)，具体方式如下：
    ```java
1.使用同步语句块的方式来锁定部分代码；
synchronized(任意类型的引用){
 编写需要锁定的代码；
}
2.使用同步方法的方式来锁定所有代码；
public synchronized void run(){
}
   ```

4. 原理分析
    1. 当多个线程调用start方法后同时去抢占共享资源，由于同步锁的存在导致只有一个线程能够抢到共享资源并进行加锁处理，其它没有抢到共享资源的线程进入阻塞状态，当该线程执行完毕所有锁定的代码后自动释放同步锁，此时阻塞状态的所有线程继续抢占共享资源，抢不到的线程再次回到阻塞状态。
5. 死锁的概念
```java
线程一执行的代码：
    public void run() {
        synchronized(a) {     持有同步锁a，等待同步锁b
            synchronized(b) {
                ...
            }
        }
    }
线程二执行的代码：
    public void run() {
        synchronized(b) {     持有同步锁b，等待同步锁a
            synchronized(a) {
                ...
            }
        }
    }
经验分享：
    在以后的开发中尽量少使用同步代码块的嵌套结构！
```

### 网络编程常识
1. 七层网络模型
    1. ISO(国际标准委员会组织)将数据的传递从逻辑上划分为以下七层：
    2. 应用层、表示层、会话层、传输层、网络层、数据链路层、物理层
    3. 当发送数据时，需要对发送的内容按照上述七层模型进行层层加包再发送出去；
    4. 当接收数据时，需要对接受的内容按照上述七层模型相反的次序层层拆包再解析出来
2. IP地址(重点)
    1. 如：192.168.1.1 - 是绝大多数路由器的登录地址，进行账号密码的配置以及Mac地址过滤
    2. IP地址 - 是互联网中的唯一标识，用于定位到具体某一台设备。
    3. IP地址本质上是由32位二进制组成的整数，叫做IPv4，当然也有128位二进制组成的整数，叫做IPv6，目前主流的还是IPv4.
    4. 日常生活中采用点分十进制表示法进行IP地址的描述，也就是将每个字节的二进制转换为一个十进制整数，不同的十进制整数之间采用小数点隔开。
3. 端口号(重点)
    1. IP地址 - 可以定位到具体某一台设备。
    2. 端口号 - 可以定位到具体某一个进程。
    3. 网络编程需要提供：IP地址 + 端口号。
    4. 端口号本质上是由16位二进制组成的整数，表示的范围：0 ~ 65535，其中0 ~ 1024之间的端口号通常被系统占用，因此开发中从1025开始使用

### 基于tcp协议的编程模型(重点)
1. 编程模型
    1. 服务器：
        1. 创建ServerSocket类型的对象并提供端口号；
        2. 等待客户端的连接请求，调用accept方法；
        3. 使用输入输出流进行通信；
        4. 关闭Socket；
    2. 客户端：
        1. 创建Socket类型的对象并提供服务器的IP地址和端口号；
        2. 使用输入输出流进行通信；
        3. 关闭Socket；
2. ServerSocket类
    1. java.net.ServerSocket类主要用于描述服务器套接字信息
    2. 常用方法
        1. ServerSocket(int port)：根据参数指定的端口号来构造对象
        2. Socket accept()：监听并接收到此套接字的连接请求
        3. void close()：用于关闭套接字
3. Socket类
    1. 1. java.net.Socket类主要用于描述客户端套接字，是两台机器间通信的端点。
    2. 常用方法
        1. Socket(String host,int port)：根据指定主机名和端口来构造对象
        2. InputStream getInputStream()：用于获取当前套接字的输入流
        3. OutputStream getOutputStream()：用于获取当前套接字的输出流
        4. void close()：用于关闭套接字











